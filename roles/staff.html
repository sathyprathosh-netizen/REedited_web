<!DOCTYPE html>
<html lang="en">

<script>
    (function () {
        try {
            var user = JSON.parse(sessionStorage.getItem('cs_user') || localStorage.getItem('cs_user'));
            var allowed = ['Super Admin', 'Admin', 'Manager', 'Staff', 'Chef', 'Cashier'];
            if (!user || !allowed.includes(user.position)) {
                window.location.replace('../login.html');
            }
        } catch (e) {
            window.location.replace('../login.html');
        }
    })();
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Staff Portal â€” CULINA-SUITE</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
    rel="stylesheet">
<link rel="stylesheet" href="../css/style.css">
<style>
    :root {
        --rb-primary: #ffb800;
        --rb-bg: #0d0f12;
    }

    body {
        background: var(--rb-bg);
        color: var(--text-primary);
        min-height: 100vh;
    }

    .rb-layout {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }

    .rb-top-bar {
        height: 70px;
        background: rgba(26, 30, 46, 0.85);
        border-bottom: 1px solid var(--border-subtle);
        backdrop-filter: blur(20px);
        padding: 0 40px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        position: sticky;
        top: 0;
        z-index: 1000;
    }

    .rb-main {
        flex: 1;
        padding: 40px;
        max-width: 100%;
        margin: 0;
        display: flex;
        flex-direction: column;
    }

    /* --- PHASE 17: LAYOUT-SAFE ANIMATIONS --- */
    .rb-card,
    .course-card,
    .rb-top-bar,
    .staff-action-btn,
    .user-add-panel,
    .inquiry-item,
    .artifact-card,
    .message-hub-container {
        position: relative;
        background: rgba(255, 255, 255, 0.03);
        backdrop-filter: blur(10px);
        border: 1px solid var(--border-subtle);
        border-radius: 12px;
        transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
        overflow: hidden;
        animation: nexus-glow-pulse 8s infinite ease-in-out;
    }

    .rb-card:hover,
    .course-card:hover {
        background: rgba(255, 255, 255, 0.05);
        border-color: rgba(255, 184, 0, 0.5);
        box-shadow: 0 0 40px rgba(255, 184, 0, 0.2);
    }

    .rb-card::before,
    .course-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 80%;
        height: 100%;
        background: linear-gradient(90deg,
                transparent,
                rgba(255, 255, 255, 0.04),
                transparent);
        animation: spectral-sweep 10s infinite linear;
        pointer-events: none;
        z-index: 1;
    }

    .rb-card::after,
    .course-card::after {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: inherit;
        padding: 1px;
        background: linear-gradient(135deg, var(--rb-primary), transparent, var(--rb-primary));
        mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        mask-composite: exclude;
        opacity: 0;
        transition: opacity 0.4s ease;
        pointer-events: none;
        z-index: 2;
    }

    .rb-card:hover::after,
    .course-card:hover::after {
        opacity: 0.4;
    }

    .staff-dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
        gap: 30px;
        margin-top: 35px;
        align-items: stretch;
        min-height: calc(100vh - 150px);
    }

    .col-performance,
    .col-operations,
    .col-logistics {
        display: flex;
        flex-direction: column;
        gap: 30px;
    }

    .rb-card {
        padding: 28px;
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .col-performance>.rb-card:last-child,
    .col-operations>.rb-card:last-child,
    .col-logistics>.rb-card:last-child {
        flex: 1;
    }

    /* Metric Ring Alignment Fix */
    .metrics-container {
        display: flex;
        justify-content: space-between;
        gap: 15px;
        margin-bottom: 25px;
    }

    .metric-item {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        text-align: center;
    }

    .metric-ring {
        width: 64px;
        height: 64px;
        background: rgba(255, 255, 255, 0.02);
        border: 2px solid rgba(255, 255, 255, 0.05);
        border-radius: 50%;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .metric-ring::after {
        content: '';
        position: absolute;
        inset: -3px;
        border-radius: 50%;
        border: 3px solid var(--rb-primary);
        border-top-color: transparent;
        border-left-color: transparent;
        animation: ring-rotate 4s ease-in-out infinite;
    }

    .rb-view {
        animation: surface-reveal 1.2s cubic-bezier(0.23, 1, 0.32, 1) forwards;
    }

    @keyframes nexus-glow-pulse {

        0%,
        100% {
            box-shadow: 0 0 15px rgba(255, 184, 0, 0.05);
        }

        50% {
            box-shadow: 0 0 40px rgba(255, 184, 0, 0.15);
        }
    }

    @keyframes spectral-sweep {
        0% {
            transform: translateX(-150%) skewX(-20deg);
            opacity: 0;
        }

        20% {
            opacity: 0.2;
        }

        40% {
            transform: translateX(250%) skewX(-20deg);
            opacity: 0;
        }

        100% {
            transform: translateX(250%) skewX(-20deg);
            opacity: 0;
        }
    }

    @keyframes surface-reveal {
        from {
            opacity: 0;
            filter: blur(20px);
            transform: translateY(0);
        }

        to {
            opacity: 1;
            filter: blur(0);
            transform: translateY(0);
        }
    }


    @media (max-width: 1400px) {
        .staff-dashboard-grid {
            grid-template-columns: 1.2fr 0.8fr;
        }

        .col-artifacts {
            grid-column: span 2;
        }
    }

    /* --- MESSAGE HUB STYLES --- */
    .message-hub-container {
        display: grid;
        grid-template-columns: 350px 1fr;
        gap: 2px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 20px;
        overflow: hidden;
        border: 1px solid var(--border-subtle);
        height: calc(100vh - 220px);
        margin-top: -20px;
    }

    .inbox-panel {
        background: rgba(0, 0, 0, 0.2);
        border-right: 1px solid var(--border-subtle);
        display: flex;
        flex-direction: column;
    }

    .chat-panel {
        display: flex;
        flex-direction: column;
        background: rgba(0, 0, 0, 0.1);
    }

    .conversation-list {
        flex: 1;
        overflow-y: auto;
    }

    .convo-item {
        padding: 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.03);
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .convo-item:hover,
    .convo-item.active {
        background: rgba(255, 255, 255, 0.05);
    }

    .chat-history {
        flex: 1;
        padding: 30px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .msg-bubble {
        max-width: 85%;
        padding: 12px 18px;
        border-radius: 12px;
        font-size: 14px;
        line-height: 1.5;
        position: relative;
    }

    .msg-staff {
        align-self: flex-end;
        background: var(--rb-primary);
        color: black;
        border-bottom-right-radius: 2px;
        font-weight: 500;
    }

    .msg-student {
        align-self: flex-start;
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-bottom-left-radius: 2px;
    }

    .chat-input-area {
        padding: 20px;
        background: rgba(0, 0, 0, 0.3);
        border-top: 1px solid var(--border-subtle);
        display: flex;
        gap: 15px;
    }

    /* --- CINEMATIC SYNC & PULSE --- */
    .sync-overlay {
        position: fixed;
        inset: 0;
        background: rgba(13, 15, 18, 0.95);
        backdrop-filter: blur(20px);
        z-index: 9999;
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 30px;
    }

    .sync-loader {
        width: 120px;
        height: 120px;
        border: 2px solid rgba(255, 184, 0, 0.1);
        border-top-color: var(--rb-primary);
        border-radius: 50%;
        animation: sync-spin 1s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        position: relative;
    }

    .sync-loader::after {
        content: 'SYNC';
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        font-weight: 900;
        color: var(--rb-primary);
        letter-spacing: 2px;
    }

    @keyframes sync-spin {
        to {
            transform: rotate(360deg);
        }
    }

    .sync-text {
        font-family: 'Courier New', monospace;
        font-size: 14px;
        color: var(--rb-primary);
        text-align: center;
        min-height: 20px;
    }

    .health-mini-card {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid var(--border-subtle);
        border-radius: 12px;
        padding: 12px;
        display: flex;
        flex-direction: column;
        gap: 5px;
        transition: all 0.3s ease;
    }

    .health-mini-card.active {
        border-color: rgba(77, 255, 136, 0.3);
        animation: health-pulse 2s infinite;
    }

    @keyframes health-pulse {
        0% {
            box-shadow: 0 0 0 0 rgba(77, 255, 136, 0.2);
        }

        70% {
            box-shadow: 0 0 0 10px rgba(77, 255, 136, 0);
        }

        100% {
            box-shadow: 0 0 0 0 rgba(77, 255, 136, 0);
        }
    }

    .rb-btn {
        background: var(--rb-primary);
        color: black;
        border: none;
        padding: 10px 20px;
        border-radius: var(--radius-md);
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .rb-btn:hover {
        transform: scale(1.05);
    }

    .rb-btn.disabled {
        opacity: 0.3;
        cursor: not-allowed;
        filter: grayscale(1);
        pointer-events: none;
    }

    .form-group {
        margin-bottom: 20px;
    }

    .form-input {
        width: 100%;
        padding: 12px;
        background: rgba(0, 0, 0, 0.2);
        border: 1px solid var(--border-subtle);
        border-radius: 8px;
        color: white;
        margin-top: 5px;
    }

    .restricted-overlay {
        position: relative;
    }

    .restricted-overlay::after {
        content: 'ðŸ”’ ADMIN ONLY';
        position: absolute;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        font-weight: 800;
        letter-spacing: 0.1em;
        color: white;
        opacity: 0;
        transition: opacity 0.3s ease;
        pointer-events: none;
        border-radius: inherit;
    }

    .restricted-overlay:hover::after {
        opacity: 1;
    }

    /* Course Grid Layout (Ported from Super Admin) */
    .course-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 25px;
        margin-top: 20px;
    }

    .course-card {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid var(--border-strong);
        border-radius: var(--radius-xl);
        overflow: hidden;
        transition: all 0.3s ease;
        height: 100%;
        display: flex;
        flex-direction: column;
        position: relative;
    }

    .course-card:hover {
        transform: translateY(-5px);
        border-color: var(--rb-primary);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
    }

    .course-image {
        width: 100%;
        height: 180px;
        object-fit: cover;
        border-bottom: 1px solid var(--border-subtle);
    }

    .course-content {
        padding: var(--space-6);
        flex: 1;
        display: flex;
        flex-direction: column;
    }

    .course-category {
        font-size: 10px;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        color: var(--rb-primary);
        font-weight: 700;
        margin-bottom: 8px;
        display: block;
    }

    .course-title {
        font-size: 20px;
        font-weight: 700;
        margin-bottom: 12px;
        color: white;
        line-height: 1.3;
    }

    .course-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 12px;
        color: var(--text-muted);
        margin-top: auto;
    }

    .instructor-tag {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .instructor-avatar {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        background: var(--rb-primary);
        color: black;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 800;
        font-size: 10px;
    }

    /* Staff Dashboard Enrichment Styles */
    /* --- NEW MODULE STYLES --- */
    .inquiry-item {
        padding: 15px;
        border-radius: 12px;
        margin-bottom: 15px;
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .priority-badge {
        font-size: 9px;
        font-weight: 800;
        padding: 3px 8px;
        border-radius: 4px;
        text-transform: uppercase;
        width: fit-content;
    }

    .p-high {
        background: rgba(255, 77, 77, 0.1);
        color: #ff4d4d;
        border: 1px solid rgba(255, 77, 77, 0.2);
    }

    .p-med {
        background: rgba(255, 184, 0, 0.1);
        color: var(--rb-primary);
        border: 1px solid rgba(255, 184, 0, 0.2);
    }

    .roadmap-track {
        position: relative;
        padding-left: 20px;
        border-left: 2px solid rgba(255, 255, 255, 0.05);
        margin: 20px 0;
    }

    .milestone {
        position: relative;
        margin-bottom: 25px;
    }

    .milestone::before {
        content: '';
        position: absolute;
        left: -27px;
        top: 4px;
        width: 12px;
        height: 12px;
        background: var(--rb-bg);
        border: 2px solid var(--rb-primary);
        border-radius: 50%;
    }

    .milestone.complete::before {
        background: var(--rb-primary);
    }

    .pulse-ticker {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 8px;
        padding: 10px 15px;
        font-size: 11px;
        font-weight: 600;
        color: var(--text-muted);
        border: 1px solid var(--border-subtle);
        overflow: hidden;
        white-space: nowrap;
        margin-top: 15px;
    }

    .ticker-content {
        display: inline-block;
        animation: ticker-roll 30s linear infinite;
    }

    @keyframes ticker-roll {
        0% {
            transform: translateX(100%);
        }

        100% {
            transform: translateX(-100%);
        }
    }

    .artifact-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
        margin-top: 15px;
    }

    .artifact-card {
        padding: 12px;
        border-radius: 10px;
        text-align: center;
        cursor: pointer;
    }

    .artifact-card i {
        display: block;
        font-size: 18px;
        margin-bottom: 5px;
        color: var(--rb-primary);
    }

    .artifact-card span {
        font-size: 11px;
        font-weight: 700;
    }

    /* Inquiry List Fine-tuning */
    .inquiry-item {
        padding: 16px;
        gap: 12px;
        border-left: 3px solid transparent;
    }

    .inquiry-item:hover {
        background: rgba(255, 255, 255, 0.05);
        border-left-color: var(--rb-primary);
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 5px;
    }

    /* --- DASHBOARD GRID REFINEMENT --- */
    .staff-dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
        gap: 30px;
    }

    .metric-ring {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        border: 4px solid rgba(255, 255, 255, 0.05);
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .metric-ring::after {
        content: '';
        position: absolute;
        inset: -4px;
        border-radius: 50%;
        border: 4px solid var(--rb-primary);
        border-top-color: transparent;
        border-left-color: transparent;
        animation: ring-rotate 4s ease-in-out infinite;
    }

    @keyframes ring-rotate {
        0% {
            transform: rotate(0deg);
        }

        50% {
            transform: rotate(180deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }

    .schedule-line {
        padding-left: 25px;
        border-left: 1px dashed var(--border-subtle);
        position: relative;
        padding-bottom: 25px;
    }

    .schedule-line::after {
        content: '';
        position: absolute;
        left: -6px;
        top: 0;
        width: 11px;
        height: 11px;
        border-radius: 50%;
        background: var(--rb-primary);
        border: 2px solid var(--rb-bg);
    }

    .progress-bar-sm {
        height: 6px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 3px;
        overflow: hidden;
        margin: 10px 0;
    }

    .progress-fill {
        height: 100%;
        background: var(--rb-primary);
        border-radius: 3px;
    }

    .staff-action-btn {
        width: 100%;
        padding: 12px;
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid var(--border-subtle);
        border-radius: 12px;
        display: flex;
        align-items: center;
        gap: 12px;
        color: var(--text-secondary);
        font-size: 13px;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .staff-action-btn:hover {
        background: rgba(255, 184, 0, 0.05);
        border-color: var(--rb-primary);
        color: white;
        transform: translateX(5px);
    }

    /* Side Panel System */
    .user-mgmt-container {
        display: flex;
        gap: 0;
        position: relative;
        overflow: hidden;
    }

    .user-table-wrapper {
        flex: 1;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .user-add-panel {
        width: 0;
        opacity: 0;
        background: rgba(26, 30, 46, 0.95);
        border: 1px solid var(--border-strong);
        border-radius: var(--radius-xl);
        padding: 0;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        overflow: hidden;
        backdrop-filter: blur(20px);
        position: relative;
    }

    .user-add-panel.active {
        width: 350px;
        opacity: 1;
        padding: var(--space-8);
        border-left: 2px solid var(--rb-primary);
        margin-left: 30px;
    }

    /* Table Alignment Fixes */
    /* --- DENSITY ENRICHMENT STYLES --- */
    .activity-feed {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-top: 15px;
    }

    .activity-item {
        display: flex;
        gap: 12px;
        padding: 10px;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 8px;
        font-size: 11px;
        border-left: 2px solid var(--rb-primary);
    }

    .activity-time {
        color: var(--text-muted);
        font-weight: 800;
        white-space: nowrap;
    }

    .deadline-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: 15px;
    }

    .deadline-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 14px;
        background: rgba(255, 77, 77, 0.05);
        border: 1px solid rgba(255, 77, 77, 0.1);
        border-radius: 8px;
        font-size: 12px;
    }

    .health-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        margin-top: 15px;
    }

    .health-mini-card {
        padding: 10px;
        background: rgba(0, 0, 0, 0.2);
        border: 1px solid var(--border-subtle);
        border-radius: 8px;
        text-align: center;
    }

    .health-label {
        font-size: 9px;
        color: var(--text-muted);
        text-transform: uppercase;
        font-weight: 800;
    }

    .health-value {
        font-size: 13px;
        font-weight: 900;
        color: #4dff88;
    }

    /* Standardized Card Padding */
    .rb-card {
        padding: 28px;
        min-height: fit-content;
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        min-height: 32px;
        /* Prevent text jumps */
    }

    .card-header h2 {
        margin: 0;
        font-size: 18px;
        font-weight: 800;
    }

    .rb-header {
        margin-bottom: 45px;
        padding-bottom: 25px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .flex-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        /* Robust centering for title+desc vs button */
    }

    .rb-header h1,
    .rb-header h2 {
        margin: 0;
        padding: 0;
        line-height: 1.1;
    }

    .rb-header p {
        margin: 12px 0 0 0;
        opacity: 0.6;
        font-size: 14px;
    }

    .rb-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0 8px;
        table-layout: fixed;
        /* Force fixed widths for perfect alignment */
    }

    .rb-table th,
    .rb-table td {
        text-align: left;
        padding: 12px 15px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    /* Define fixed column widths */
    .col-name {
        width: 25%;
    }

    .col-email {
        width: 30%;
    }

    .col-tracks {
        width: 15%;
    }

    .col-active {
        width: 20%;
    }

    .col-action {
        width: 10%;
        text-align: right;
    }

    .rb-table th {
        color: var(--text-muted);
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.1em;
    }

    .rb-table td {
        background: rgba(255, 255, 255, 0.02);
        border-top: 1px solid var(--border-subtle);
        border-bottom: 1px solid var(--border-subtle);
    }

    .rb-table tr td:first-child {
        border-left: 1px solid var(--border-subtle);
        border-top-left-radius: 12px;
        border-bottom-left-radius: 12px;
    }

    .rb-table tr td:last-child {
        border-right: 1px solid var(--border-subtle);
        border-top-right-radius: 12px;
        border-bottom-right-radius: 12px;
        text-align: right;
    }

    /* --- RESPONSIVE DESIGN (STAFF PORTAL) --- */
    @media (max-width: 1200px) {
        .staff-dashboard-grid {
            grid-template-columns: 1fr 1fr;
        }

        .col-logistics {
            grid-column: span 2;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
    }

    @media (max-width: 1024px) {
        .rb-top-bar {
            padding: 0 20px;
        }

        .message-hub-container {
            grid-template-columns: 280px 1fr;
        }

        .metrics-container {
            flex-wrap: wrap;
            justify-content: center;
        }
    }

    @media (max-width: 900px) {
        .staff-dashboard-grid {
            grid-template-columns: 1fr;
        }

        .col-logistics {
            grid-template-columns: 1fr;
            grid-column: span 1;
        }

        .message-hub-container {
            grid-template-columns: 1fr;
            height: auto;
            min-height: calc(100vh - 200px);
        }

        .inbox-panel {
            border-right: none;
            border-bottom: 2px solid var(--border-subtle);
            max-height: 300px;
        }
    }

    @media (max-width: 768px) {
        .rb-top-bar {
            height: auto;
            flex-direction: column;
            padding: 15px 20px;
            gap: 15px;
        }

        .rb-top-bar>div:nth-child(2) {
            width: 100%;
            overflow-x: auto;
            padding-bottom: 5px;
            justify-content: flex-start !important;
            scrollbar-width: none;
        }

        .rb-top-bar>div:nth-child(2)::-webkit-scrollbar {
            display: none;
        }

        .rb-top-bar .view-btn {
            flex-shrink: 0;
            white-space: nowrap;
            font-size: 10px;
        }

        .rb-top-bar>div:last-child {
            width: 100%;
            justify-content: center !important;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            padding-top: 10px;
        }

        .rb-main {
            padding: 25px 20px;
        }

        .rb-header.flex-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 20px;
        }

        .rb-header h1 {
            font-size: 28px !important;
        }

        .user-mgmt-container {
            flex-direction: column;
        }

        .user-table-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .rb-table {
            min-width: 800px;
            /* Force table width to allow scrolling */
        }

        .user-add-panel.active {
            width: 100%;
            margin-left: 0;
            margin-top: 30px;
        }
    }

    @media (max-width: 480px) {
        .artifact-grid {
            grid-template-columns: 1fr;
        }

        .metric-item {
            flex: none;
            width: 100%;
        }

        .rb-card {
            padding: 20px;
        }
    }

    /* --- MODAL SYSTEM --- */
    .rb-modal {
        position: fixed;
        inset: 0;
        background: rgba(13, 15, 18, 0.9);
        backdrop-filter: blur(15px);
        z-index: 2000;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 20px;
        animation: modal-backdrop-in 0.4s ease forwards;
    }

    .rb-modal.active {
        display: flex;
    }

    .modal-content {
        background: rgba(26, 30, 46, 0.95);
        border: 1px solid var(--border-subtle);
        border-radius: 20px;
        width: 100%;
        max-width: 600px;
        max-height: 90vh;
        overflow-y: auto;
        position: relative;
        padding: 40px;
        box-shadow: 0 30px 60px rgba(0, 0, 0, 0.5);
        animation: modal-content-in 0.5s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
    }

    @keyframes modal-backdrop-in {
        from {
            opacity: 0;
        }

        to {
            opacity: 1;
        }
    }

    @keyframes modal-content-in {
        from {
            opacity: 0;
            transform: translateY(40px) scale(0.95);
        }

        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    .close-modal {
        position: absolute;
        top: 20px;
        right: 20px;
        background: rgba(255, 255, 255, 0.05);
        border: none;
        color: white;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 20px;
    }

    .close-modal:hover {
        background: rgba(255, 77, 77, 0.2);
        color: #ff4d4d;
        transform: rotate(90deg);
    }

    .roster-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-top: 20px;
    }

    .roster-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 15px;
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid var(--border-subtle);
        border-radius: 12px;
        transition: all 0.3s ease;
    }

    .roster-item:hover {
        border-color: var(--rb-primary);
        background: rgba(255, 184, 0, 0.05);
    }
</style>
</head>

<body>
    <div class="rb-layout">
        <nav class="rb-top-bar">
            <div class="login-logo" style="margin: 0; font-size: 20px;">CULINA<span>-SUITE</span></div>
            <div style="display: flex; gap: 10px; align-items: center;">
                <a href="javascript:void(0)" onclick="switchView('overview')" class="rb-btn view-btn active"
                    id="btn-overview" style="background: rgba(255,255,255,0.05); color: white;">â—ˆ Dashboard</a>
                <a href="javascript:void(0)" onclick="switchView('messages')" class="rb-btn view-btn" id="btn-messages"
                    style="background: rgba(255,255,255,0.05); color: white;">ï¿½ Inbox</a>
                <a href="javascript:void(0)" onclick="switchView('students')" class="rb-btn view-btn" id="btn-students"
                    style="background: rgba(255,255,255,0.05); color: white;">ï¿½ My Students</a>
                <a href="javascript:void(0)" onclick="switchView('courses')" class="rb-btn view-btn" id="btn-courses"
                    style="background: rgba(255,255,255,0.05); color: white;">ï¿½ Course Viewer</a>
            </div>
            <div style="display: flex; align-items: center; gap: 15px;">
                <div style="text-align: right; line-height: 1.2;">
                    <div style="font-size: 9px; color: var(--text-muted); font-weight: 800; letter-spacing: 0.1em;">
                        COMMANDER</div>
                    <div id="staff-name" style="font-size: 13px; font-weight: 900; color: var(--rb-primary);">Staff
                    </div>
                </div>
                <a href="javascript:void(0)" onclick="handleGlobalSync()" class="rb-btn sync-btn"
                    style="background: rgba(255,184,0,0.1); color: var(--rb-primary); font-weight: 800; font-size: 11px; padding: 10px 18px; border: 1px solid rgba(255,184,0,0.2);">ðŸ”„
                    SYNC</a>
                <a href="../login.html" onclick="sessionStorage.removeItem('cs_user')" class="rb-btn"
                    style="background: var(--color-critical); color: white; padding: 10px 18px; font-size: 11px; border: 1px solid rgba(255,255,255,0.1);">Logout</a>
            </div>
        </nav>

        <main class="rb-main">
            <!-- Overview View -->
            <div id="view-overview" class="rb-view">
                <header class="rb-header flex-header">
                    <div>
                        <div class="hero__eyebrow" style="margin-bottom: 10px;">Academic Operations</div>
                        <h1 style="font-size: 36px; font-weight: 900;">Staff <span class="highlight"
                                style="color: var(--rb-primary);">Command Center</span></h1>
                        <p style="color: var(--text-secondary); font-size: 16px;">Oversee curriculum delivery and
                            monitor student success rates.</p>
                    </div>
                </header>

                <div class="staff-dashboard-grid" style="margin-bottom: 0; flex: 1;">
                    <!-- Column 1: Performance & Growth -->
                    <div class="col-performance">
                        <section class="rb-card">
                            <div class="card-header">
                                <h2>Instructional Health</h2>
                                <span class="badge"
                                    style="background: rgba(255,184,0,0.1); color: var(--rb-primary); padding: 5px 12px; border-radius: 20px; font-size: 10px; font-weight: 800; white-space: nowrap;">LIVE</span>
                            </div>

                            <div class="metrics-container">
                                <div class="metric-item">
                                    <div class="metric-ring">
                                        <div style="font-size: 14px; font-weight: 900;">92%</div>
                                    </div>
                                    <div
                                        style="font-size: 10px; color: var(--text-muted); font-weight: 800; text-transform: uppercase;">
                                        Engagement</div>
                                </div>
                                <div class="metric-item">
                                    <div class="metric-ring" style="border-color: rgba(255,77,77,0.2);">
                                        <div style="font-size: 14px; font-weight: 900; color: #ff4d4d;">14h</div>
                                    </div>
                                    <div
                                        style="font-size: 10px; color: var(--text-muted); font-weight: 800; text-transform: uppercase;">
                                        Grading</div>
                                </div>
                                <div class="metric-item">
                                    <div class="metric-ring">
                                        <div style="font-size: 14px; font-weight: 900;">85%</div>
                                    </div>
                                    <div
                                        style="font-size: 10px; color: var(--text-muted); font-weight: 800; text-transform: uppercase;">
                                        Success</div>
                                </div>
                            </div>

                            <div style="display: flex; flex-direction: column; gap: 15px;">
                                <div>
                                    <div
                                        style="display: flex; justify-content: space-between; font-size: 11px; margin-bottom: 6px;">
                                        <span style="color: var(--text-muted);">Enrollment Velocity</span>
                                        <span style="color: var(--rb-primary); font-weight: 800;">+24%</span>
                                    </div>
                                    <div class="progress-bar-sm">
                                        <div class="progress-fill" style="width: 65%;"></div>
                                    </div>
                                </div>
                                <div>
                                    <div
                                        style="display: flex; justify-content: space-between; font-size: 11px; margin-bottom: 6px;">
                                        <span style="color: var(--text-muted);">Submission Rate</span>
                                        <span style="font-weight: 800; color: #4d94ff;">78%</span>
                                    </div>
                                    <div class="progress-bar-sm">
                                        <div class="progress-fill" style="width: 78%; background: #4d94ff;"></div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <section class="rb-card">
                            <div class="card-header">
                                <h2>Academic Deadlines</h2>
                                <span
                                    style="font-size: 10px; color: var(--text-muted); font-weight: 800; opacity: 0.6;">3
                                    EVENTS</span>
                            </div>
                            <div class="deadline-list">
                                <div class="deadline-item"
                                    style="background: rgba(255,184,0,0.05); border-color: rgba(255,184,0,0.1);">
                                    <span>Q1 Assessment Lock</span>
                                    <span style="color: var(--rb-primary); font-weight: 800;">TOMORROW</span>
                                </div>
                                <div class="deadline-item">
                                    <span>Final Grade Sweep</span>
                                    <span style="font-weight: 800;">48h REMAINING</span>
                                </div>
                                <div class="deadline-item"
                                    style="background: rgba(77,255,136,0.05); border-color: rgba(77,255,136,0.1);">
                                    <span>Syllabus Sync (Q2)</span>
                                    <span style="color: #4dff88; font-weight: 800;">COMPLETED</span>
                                </div>
                            </div>
                        </section>

                        <section class="rb-card">
                            <div class="card-header">
                                <h2>Learning Artifacts</h2>
                                <span
                                    style="font-size: 10px; color: var(--text-muted); font-weight: 800; opacity: 0.6;">10
                                    TOOLS</span>
                            </div>
                            <div class="artifact-grid">
                                <div class="artifact-card">â—ˆ <span>Rubrics</span></div>
                                <div class="artifact-card">â–¤ <span>Syllabi</span></div>
                                <div class="artifact-card">â—Ž <span>Assessments</span></div>
                                <div class="artifact-card">â–£ <span>Templates</span></div>
                                <div class="artifact-card">âš™ <span>Rubrics++</span></div>
                                <div class="artifact-card">ðŸ—‚ <span>Archives</span></div>
                                <div class="artifact-card">ðŸ“Š <span>Metrics</span></div>
                                <div class="artifact-card">ðŸ“‹ <span>Logs</span></div>
                                <div class="artifact-card">ðŸ“‘ <span>Handouts</span></div>
                                <div class="artifact-card">ðŸ’¾ <span>Backups</span></div>
                            </div>
                        </section>
                    </div>

                    <!-- Column 2: Student Operations -->
                    <div class="col-operations">
                        <section class="rb-card">
                            <div class="card-header">
                                <h2>Student Inquiries</h2>
                                <span
                                    style="font-size: 10px; color: var(--text-muted); font-weight: 800; opacity: 0.6; white-space: nowrap;">3
                                    PENDING</span>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 15px; margin-top: 10px;">
                                <div class="inquiry-item">
                                    <div class="priority-badge p-high">URGENT</div>
                                    <div style="font-size: 14px; font-weight: 700;">Subhash: Access Denied</div>
                                    <div style="font-size: 12px; color: var(--text-muted);">Kitchen 101 Module 4 lock...
                                    </div>
                                </div>
                                <div class="inquiry-item">
                                    <div class="priority-badge p-med">PRIORITY</div>
                                    <div style="font-size: 14px; font-weight: 700;">Anand: Grading Query</div>
                                    <div style="font-size: 12px; color: var(--text-muted);">Re-submission pending
                                        review...</div>
                                </div>
                            </div>
                            <button class="rb-btn" onclick="switchView('messages')"
                                style="width: 100%; padding: 12px; font-size: 12px; margin-top: 10px;">View Message Hub
                                â†’</button>
                        </section>

                        <section class="rb-card" style="background: rgba(0,0,0,0.15);">
                            <div class="card-header">
                                <h2>Faculty Activity</h2>
                                <span class="badge"
                                    style="background: rgba(77,255,136,0.1); color: #4dff88; font-size: 9px; padding: 4px 8px; border-radius: 4px; font-weight: 800;">SYNCED</span>
                            </div>
                            <div class="activity-feed">
                                <div class="activity-item">
                                    <span class="activity-time">09:42 AM</span>
                                    <span>Sync process initialized for Menu Vector alpha.</span>
                                </div>
                                <div class="activity-item" style="border-left-color: #4d94ff;">
                                    <span class="activity-time">09:12 AM</span>
                                    <span>Admin: Added 12 new items to Cloud POS.</span>
                                </div>
                                <div class="activity-item">
                                    <span class="activity-time">08:50 AM</span>
                                    <span>System: Security sweep completed (0 issues).</span>
                                </div>
                                <div class="activity-item" style="border-left-color: #ff4d4d; opacity: 0.8;">
                                    <span class="activity-time">08:30 AM</span>
                                    <span>Incident: Subhash reported access blockage.</span>
                                </div>
                            </div>
                        </section>

                        <section class="rb-card">
                            <div class="card-header">
                                <h2>Direct Registration</h2>
                                <span class="badge"
                                    style="background: rgba(255,184,0,0.1); color: var(--rb-primary); font-size: 9px; padding: 4px 8px; border-radius: 4px; font-weight: 800;">QUICK
                                    ACTIONS</span>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 15px; margin-top: 10px;">
                                <div class="form-group" style="margin: 0;">
                                    <label
                                        style="font-size: 10px; color: var(--text-muted); text-transform: uppercase; font-weight: 700; letter-spacing: 0.05em;">Student
                                        Identity</label>
                                    <input type="text" class="form-input" id="newStudentName" placeholder="Full Name"
                                        style="padding: 12px; font-size: 13px;">
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <label
                                        style="font-size: 10px; color: var(--text-muted); text-transform: uppercase; font-weight: 700; letter-spacing: 0.05em;">Communication
                                        Vector</label>
                                    <input type="email" class="form-input" id="newStudentEmail"
                                        placeholder="Email Address" style="padding: 12px; font-size: 13px;">
                                </div>
                                <button class="rb-btn"
                                    style="width: 100%; padding: 14px; margin-top: 5px; font-size: 12px;"
                                    onclick="enrollStudent()">Initialize Registration ++</button>
                            </div>
                        </section>
                    </div>

                    <!-- Column 3: Logistics & Monitoring -->
                    <div class="col-logistics">
                        <section class="rb-card">
                            <div class="card-header">
                                <h2>Session Queue</h2>
                                <span
                                    style="font-size: 10px; color: var(--text-muted); font-weight: 800; opacity: 0.6;">TODAY</span>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 15px; margin-top: 15px;">
                                <div class="schedule-line">
                                    <div style="font-size: 10px; font-weight: 800; color: var(--rb-primary);">09:00 AM â€”
                                        LIVE</div>
                                    <div style="font-size: 14px; font-weight: 700;">Culinary Basics 101</div>
                                </div>
                                <div class="schedule-line">
                                    <div style="font-size: 10px; font-weight: 800; color: var(--text-muted);">11:30 AM
                                    </div>
                                    <div style="font-size: 14px; font-weight: 700;">Advanced Pastry Arts</div>
                                </div>
                            </div>
                            <div class="pulse-ticker">
                                <div class="ticker-content">
                                    Faculty Board: All grading cycles must be finalized by Friday 6 PM. | New Lab Safety
                                    Protocol released for Q2. | Enrollment portal maintenance scheduled for 11 PM.
                                </div>
                            </div>
                        </section>

                        <section class="rb-card">
                            <div class="card-header">
                                <h2>Curriculum Roadmap</h2>
                                <span class="badge"
                                    style="background: rgba(77,255,136,0.1); color: #4dff88; font-size: 9px; padding: 4px 8px; border-radius: 4px; font-weight: 800;">Q1/Q2
                                    TRACKING</span>
                            </div>
                            <div class="roadmap-track">
                                <div class="milestone complete">
                                    <div style="font-size: 11px; font-weight: 800; color: var(--rb-primary);">Q1
                                        DEPLOYED</div>
                                    <div style="font-size: 14px; font-weight: 700;">Foundation Techniques</div>
                                </div>
                                <div class="milestone">
                                    <div style="font-size: 11px; font-weight: 800; color: var(--text-muted);">IN
                                        PROGRESS</div>
                                    <div style="font-size: 14px; font-weight: 700;">Global Cuisines Beta</div>
                                </div>
                                <div class="milestone">
                                    <div
                                        style="font-size: 11px; font-weight: 800; color: var(--text-muted); opacity: 0.5;">
                                        Q2 PLANNING</div>
                                    <div style="font-size: 14px; font-weight: 700; opacity: 0.5;">Molecular Gastronomy
                                    </div>
                                </div>
                            </div>
                        </section>

                        <section class="rb-card">
                            <div class="card-header">
                                <h2>Infrastructure Health</h2>
                                <div class="health-label" style="color: #4dff88;">REAL-TIME</div>
                            </div>
                            <div class="health-grid">
                                <div class="health-mini-card active">
                                    <div class="health-label">Latencies</div>
                                    <div class="health-value">12ms</div>
                                </div>
                                <div class="health-mini-card active" style="animation-delay: 0.5s;">
                                    <div class="health-label">Database</div>
                                    <div class="health-value">OPTIMAL</div>
                                </div>
                                <div class="health-mini-card active" style="animation-delay: 1s;">
                                    <div class="health-label">API Load</div>
                                    <div class="health-value" style="color: var(--rb-primary);">MODERATE</div>
                                </div>
                                <div class="health-mini-card active" style="animation-delay: 1.5s;">
                                    <div class="health-label">Sync Health</div>
                                    <div class="health-value">100%</div>
                                </div>
                            </div>
                            <div
                                style="display: flex; justify-content: space-between; padding: 12px; background: rgba(0,0,0,0.2); border-radius: 8px; font-size: 10px; font-weight: 800; border: 1px solid var(--border-subtle); margin-top: 20px;">
                                <span>CORE ENGINE: ACTIVE</span>
                                <span style="color: var(--rb-primary);">UPTIME: 99.99%</span>
                            </div>
                        </section>
                    </div>
                </div>
            </div>

            <!-- Message Hub View -->
            <div id="view-messages" class="rb-view" style="display: none;">
                <header class="rb-header flex-header">
                    <div>
                        <h2 style="font-size: 32px;">Message <span class="highlight"
                                style="color: var(--rb-primary);">Hub</span></h2>
                        <p style="color: var(--text-secondary);">Direct communication with students and faculty.</p>
                    </div>
                </header>

                <div class="message-hub-container">
                    <div class="inbox-panel">
                        <div
                            style="padding: 20px; border-bottom: 1px solid var(--border-subtle); font-size: 11px; font-weight: 800; color: var(--text-muted); letter-spacing: 1px;">
                            ACTIVE CONVERSATIONS</div>
                        <div class="conversation-list" id="inbox-list">
                            <div class="convo-item active" onclick="selectConvo('Subhash', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Subhash (Student)</span>
                                    <span style="font-size: 10px; color: #ff4d4d; font-weight: 800;">URGENT</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    Module 4 still locked after registration...</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Anand', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Anand (Student)</span>
                                    <span style="font-size: 10px; color: var(--rb-primary);">PRIORITY</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    Grading query regarding Session 12...</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Priya', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Priya Verma</span>
                                    <span style="font-size: 10px; color: #4dff88; font-weight: 800;">NEW</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    I've submitted my final assignment.</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Vikram', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Vikram Singh</span>
                                    <span style="font-size: 10px; color: var(--text-muted);">ARCHIVED</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    Thanks for the course access info.</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Sneha', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Sneha Kapur</span>
                                    <span style="font-size: 10px; color: #ffb800;">PENDING</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    Can we reschedule the audit call?</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Amit', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Amit Jain</span>
                                    <span style="font-size: 10px; color: #4dff88; font-weight: 800;">NEW</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    Just checking on my enrollment status.</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Ananya', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Ananya Iyer</span>
                                    <span style="font-size: 10px; color: #ff4d4d; font-weight: 800;">URGENT</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    Login credentials not working.</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Rohan', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Rohan Gupta</span>
                                    <span style="font-size: 10px; color: #4dff88; font-weight: 800;">NEW</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    Requesting certificate for Level 1.</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Ishita', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Ishita Dayal</span>
                                    <span style="font-size: 10px; color: var(--rb-primary);">PRIORITY</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    Extension needed for Module 2.</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Arjun', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Arjun Reddy</span>
                                    <span style="font-size: 10px; color: var(--text-muted);">ARCHIVED</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    Session 5 was very helpful, thanks.</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Saira', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Saira Banu</span>
                                    <span style="font-size: 10px; color: #ffb800;">PENDING</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    When will the next batch start?</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Kabir', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Kabir Singh</span>
                                    <span style="font-size: 10px; color: #4dff88; font-weight: 800;">NEW</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    Payment confirmation required.</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Meera', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Meera Nair</span>
                                    <span style="font-size: 10px; color: var(--rb-primary);">PRIORITY</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    Mistake in name on the profile.</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Aditya', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Aditya Rao</span>
                                    <span style="font-size: 10px; color: #4dff88; font-weight: 800;">NEW</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    How to access the culinary library?</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Zoya', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Zoya Khan</span>
                                    <span style="font-size: 10px; color: #ffb800;">PENDING</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    Need help with the fermentation module.</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Dev', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Dev Thadani</span>
                                    <span style="font-size: 10px; color: #4dff88; font-weight: 800;">NEW</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    How to join the student council?</div>
                            </div>
                            <div class="convo-item" onclick="selectConvo('Siddharth', this)">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="font-weight: 800;">Siddharth M</span>
                                    <span style="font-size: 10px; color: var(--rb-primary);">PRIORITY</span>
                                </div>
                                <div
                                    style="font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                    Feedback on the last culinary audit.</div>
                            </div>
                        </div>
                    </div>
                    <div class="chat-panel">
                        <div
                            style="padding: 20px; border-bottom: 1px solid var(--border-subtle); display: flex; align-items: center; gap: 10px;">
                            <div
                                style="width: 10px; height: 10px; border-radius: 50%; background: #4dff88; box-shadow: 0 0 10px #4dff88;">
                            </div>
                            <span style="font-weight: 800; font-size: 14px;">Chat with Subhash</span>
                        </div>
                        <div class="chat-history" id="chat-history">
                            <div class="msg-bubble msg-student">Hello, I registered for Kitchen 101 but Module 4 is
                                still showing as locked. Can you please check?</div>
                            <div class="msg-bubble msg-staff">Hi Subhash, I can see your registration was successful.
                                I'm manually unlocking the module for you now. Please refresh in 2 minutes.</div>
                            <div class="msg-bubble msg-student">Thank you! It's working now.</div>
                        </div>
                        <div class="chat-input-area">
                            <input type="text" id="chat-input" class="form-input"
                                style="flex: 1; margin: 0; padding: 14px;" placeholder="Type your response..."
                                onkeypress="if(event.key === 'Enter') sendMessage()">
                            <button class="rb-btn" onclick="sendMessage()" style="padding: 10px 25px;">Send</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Students View -->
            <div id="view-students" class="rb-view" style="display: none;">
                <div class="user-mgmt-container">
                    <div class="user-table-wrapper">
                        <header class="rb-header flex-header">
                            <div>
                                <h2 style="font-size: 32px;">Directory <span class="highlight"
                                        style="color: var(--rb-primary);">Access</span></h2>
                                <p style="color: var(--text-secondary);">Manage student enrollments and track progress.
                                </p>
                            </div>
                            <button class="rb-btn" id="add-student-trigger" onclick="toggleAddStudentForm()"
                                style="padding: 12px 28px; background: var(--rb-primary); color: black; font-weight: 800; font-size: 13px; border-radius: 8px;">+
                                Add Student</button>
                        </header>
                        <section class="rb-card">
                            <table class="rb-table">
                                <thead>
                                    <tr>
                                        <th class="col-name">Student Identity</th>
                                        <th class="col-email">Contact</th>
                                        <th class="col-tracks">Enrolled Courses</th>
                                        <th class="col-active">Last Active</th>
                                        <th class="col-action">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="student-table-body">
                                    <!-- Polulated via JS -->
                                </tbody>
                            </table>
                        </section>
                    </div>

                    <aside class="user-add-panel" id="student-add-panel">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h4 style="margin: 0; font-size: 18px;">Register Student</h4>
                            <button onclick="toggleAddStudentForm()"
                                style="background: none; border: none; color: var(--text-muted); cursor: pointer; font-size: 24px;">Ã—</button>
                        </div>
                        <form id="add-student-form" onsubmit="handleAddNewStudent(event)">
                            <div class="form-group">
                                <label
                                    style="font-size: 11px; color: var(--text-muted); text-transform: uppercase;">Full
                                    Name</label>
                                <input type="text" id="new-std-name" class="form-input" placeholder="e.g. Rahul Sharma"
                                    required>
                            </div>
                            <div class="form-group">
                                <label
                                    style="font-size: 11px; color: var(--text-muted); text-transform: uppercase;">Email
                                    Address</label>
                                <input type="email" id="new-std-email" class="form-input" placeholder="rahul@culina.com"
                                    required>
                            </div>
                            <div class="form-group">
                                <label
                                    style="font-size: 11px; color: var(--text-muted); text-transform: uppercase;">Course
                                    Tracks</label>
                                <input type="number" id="new-std-courses" class="form-input" min="1" max="10" value="1"
                                    required>
                            </div>
                            <button type="submit" class="rb-btn" style="width: 100%; margin-top: 10px;">Complete
                                Enrollment</button>
                        </form>
                    </aside>
                </div>
            </div>

            <!-- Courses View -->
            <div id="view-courses" class="rb-view" style="display: none;">
                <header class="rb-header flex-header">
                    <div>
                        <h2 style="font-size: 32px;">Course <span class="highlight"
                                style="color: var(--rb-primary);">Observation</span></h2>
                        <p style="color: var(--text-secondary);">Large-scale overview of curriculum delivery and
                            enrollment.</p>
                    </div>
                </header>
                <div id="course-observation-grid" class="course-grid">
                    <!-- Courses via JS -->
                </div>
            </div>
        </main>
    </div>

    <div id="sync-overlay" class="sync-overlay">
        <div class="sync-loader"></div>
        <div id="sync-console" class="sync-text">INITIALIZING QUANTUM HANDSHAKE...</div>
    </div>

    <!-- Audit Modal -->
    <div id="audit-modal" class="rb-modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('audit-modal')">Ã—</button>
            <div id="audit-data">
                <!-- Dynamic Content -->
            </div>
        </div>
    </div>

    <!-- Roster Modal -->
    <div id="roster-modal" class="rb-modal">
        <div class="modal-content" style="max-width: 500px;">
            <button class="close-modal" onclick="closeModal('roster-modal')">Ã—</button>
            <div id="roster-data">
                <!-- Dynamic Content -->
            </div>
        </div>
    </div>

    <script src="../js/script.js"></script>
    <script>
        function handleGlobalSync() {
            const overlay = document.getElementById('sync-overlay');
            const consoleText = document.getElementById('sync-console');
            overlay.style.display = 'flex';

            const steps = [
                "ESTABLISHING SECURE TUNNEL...",
                "CLEANING LOCAL CACHE VECTORS...",
                "SYNCING STUDENT REPOSITORY [32 RECORDS]...",
                "MAPPING COURSE ARTIFACTS...",
                "VERIFYING SYSTEM INTEGRITY...",
                "SYNC COMPLETE. NEXUS SECURED."
            ];

            let step = 0;
            const interval = setInterval(() => {
                if (step < steps.length) {
                    consoleText.textContent = steps[step];
                    step++;
                } else {
                    clearInterval(interval);
                    setTimeout(() => {
                        overlay.style.display = 'none';
                        if (typeof showToast === 'function') showToast('System Data Fully Synchronized', 'success');
                    }, 800);
                }
            }, 600);
        }

        document.addEventListener('DOMContentLoaded', () => {
            const user = checkAuth();
            if (!user || !['Staff', 'Manager', 'Super Admin'].includes(user.position)) return;
            document.getElementById('staff-name').textContent = user.name.split(' ')[0];

            loadObservation();
        });

        function switchView(viewName) {
            document.querySelectorAll('.rb-view').forEach(v => v.style.display = 'none');
            document.getElementById(`view-${viewName}`).style.display = 'block';
            document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${viewName}`).classList.add('active');

            if (viewName === 'students') loadStudents();
            if (viewName === 'courses') loadObservation();
        }

        function loadObservation() {
            const courses = JSON.parse(localStorage.getItem('cs_courses') || '[]');
            const viewer = document.getElementById('course-observation-grid');
            if (!viewer) return;

            viewer.innerHTML = courses.map(c => `
                <div class="course-card" style="animation: entry 0.5s cubic-bezier(0.4, 0, 0.2, 1) backwards;">
                    <img src="${c.image || 'https://images.unsplash.com/photo-1556910103-1c02745aae4d?auto=format&fit=crop&w=400&q=80'}" class="course-image" alt="${c.name}">
                    <div class="course-content">
                        <span class="course-category">${c.category || 'Training'}</span>
                        <h3 class="course-title" style="font-size: 18px;">${c.name}</h3>
                        <div class="course-meta">
                            <span class="instructor-tag">
                                <div class="instructor-avatar">${(c.instructor || 'U').charAt(0)}</div>
                                <span>${c.instructor}</span>
                            </span>
                            <span class="student-count" style="font-weight: 700; color: var(--rb-primary); font-size: 11px;">ðŸ‘¥ ${c.students}</span>
                        </div>
                        <div style="margin-top: auto; padding-top: 15px; display: flex; gap: 8px;">
                            <button class="rb-btn" onclick="openAudit(${c.id})" style="flex: 1; padding: 6px; font-size: 10px; background: rgba(255,255,255,0.05);">Audit</button>
                            <button class="rb-btn" onclick="openRoster(${c.id})" style="flex: 1; padding: 6px; font-size: 10px; background: rgba(255,184,0,0.1); color: var(--rb-primary);">Roster</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function loadStudents() {
            let students = JSON.parse(localStorage.getItem('cs_students'));

            // Force load the massive 32-student dataset if not already present
            if (!students || students.length < 30) {
                students = [
                    { id: 101, name: 'abc', email: 'abc@gmail.com', courses: 1, last: 'Just Now' },
                    { id: 102, name: 'karan', email: 'karan@student.com', courses: 1, last: 'Active Now' },
                    { id: 1, name: 'Rahul Sharma', email: 'rahul@culina.com', courses: 4, last: '2m ago' },
                    { id: 2, name: 'Priya Verma', email: 'priya@culina.com', courses: 2, last: '15m ago' },
                    { id: 3, name: 'Vikram Singh', email: 'vikram@culina.com', courses: 5, last: 'Today' },
                    { id: 4, name: 'Sneha Kapur', email: 'sneha@culina.com', courses: 3, last: 'Yesterday' },
                    { id: 5, name: 'Amit Jain', email: 'amit@culina.com', courses: 1, last: '3h ago' },
                    { id: 6, name: 'Karan Mehra', email: 'karan@culina.com', courses: 6, last: 'Active Now' },
                    { id: 7, name: 'Ananya Iyer', email: 'ananya@culina.com', courses: 3, last: '5h ago' },
                    { id: 8, name: 'Rohan Gupta', email: 'rohan@culina.com', courses: 2, last: 'Just Now' },
                    { id: 9, name: 'Ishita Dayal', email: 'ishita@culina.com', courses: 4, last: '10m ago' },
                    { id: 10, name: 'Arjun Reddy', email: 'arjun@culina.com', courses: 2, last: 'Active Now' },
                    { id: 11, name: 'Saira Banu', email: 'saira@culina.com', courses: 5, last: '1h ago' },
                    { id: 12, name: 'Kabir Singh', email: 'kabir@culina.com', courses: 3, last: 'Today' },
                    { id: 13, name: 'Meera Nair', email: 'meera@culina.com', courses: 1, last: 'Yesterday' },
                    { id: 14, name: 'Aditya Rao', email: 'aditya@culina.com', courses: 6, last: 'Active Now' },
                    { id: 15, name: 'Zoya Khan', email: 'zoya@culina.com', courses: 3, last: '5m ago' },
                    { id: 16, name: 'Dev Thadani', email: 'dev@culina.com', courses: 2, last: 'Just Now' },
                    { id: 17, name: 'Kiara Advani', email: 'kiara@culina.com', courses: 4, last: 'Yesterday' },
                    { id: 18, name: 'Siddharth M', email: 'sid@culina.com', courses: 5, last: 'Today' },
                    { id: 19, name: 'Rhea Kapoor', email: 'rhea@culina.com', courses: 2, last: '2h ago' },
                    { id: 20, name: 'Varun Dhawan', email: 'varun@culina.com', courses: 3, last: 'Active Now' },
                    { id: 21, name: 'Sara Ali', email: 'sara@culina.com', courses: 6, last: '10m ago' },
                    { id: 22, name: 'Janhvi K', email: 'janhvi@culina.com', courses: 1, last: 'Yesterday' },
                    { id: 23, name: 'Kartik Aaryan', email: 'kartik@culina.com', courses: 4, last: 'Active Now' },
                    { id: 24, name: 'Alia Bhatt', email: 'alia@culina.com', courses: 3, last: 'Just Now' },
                    { id: 25, name: 'Ranbir K', email: 'ranbir@culina.com', courses: 5, last: 'Today' },
                    { id: 26, name: 'Deepika P', email: 'deepika@culina.com', courses: 2, last: 'Yesterday' },
                    { id: 27, name: 'Ranveer S', email: 'ranveer@culina.com', courses: 6, last: 'Active Now' },
                    { id: 28, name: 'Vicky K', email: 'vicky@culina.com', courses: 3, last: '1h ago' },
                    { id: 29, name: 'Katrina K', email: 'kat@culina.com', courses: 4, last: 'Just Now' },
                    { id: 30, name: 'Hrithik R', email: 'hrithik@culina.com', courses: 5, last: 'Active Now' },
                    { id: 31, name: 'Anupa S', email: 'anupa@student.com', courses: 2, last: 'Active Now' },
                    { id: 32, name: 'Rajesh K', email: 'rajesh@student.com', courses: 3, last: '6h ago' }
                ];
                localStorage.setItem('cs_students', JSON.stringify(students));
            }

            const body = document.getElementById('student-table-body');
            if (!body) return;

            body.innerHTML = students.map(s => `
                <tr style="animation: entry 0.4s ease backwards;">
                    <td class="col-name"><div style="display: flex; align-items: center; gap: 10px;">
                        <div style="width: 32px; height: 32px; border-radius: 50%; background: var(--rb-primary); color: black; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 12px;">${s.name.charAt(0)}</div>
                        <strong>${s.name}</strong>
                    </div></td>
                    <td class="col-email" style="color: var(--text-muted); font-size: 13px;">${s.email}</td>
                    <td class="col-tracks"><span class="badge" style="background: rgba(255, 184, 0, 0.1); color: var(--rb-primary); padding: 4px 10px; border-radius: 20px; font-size: 11px; font-weight: 700;">${s.courses} Tracks</span></td>
                    <td class="col-active" style="font-size: 12px; color: var(--text-muted);">${s.last}</td>
                    <td class="col-action">
                        <button class="rb-btn" onclick="deleteStudent(${s.id})" style="padding: 4px 16px; font-size: 10px; background: rgba(255, 77, 77, 0.1); border: 1px solid rgba(255, 77, 77, 0.2); color: #ff4d4d; border-radius: 20px;">Remove</button>
                    </td>
                </tr>
            `).join('');
        }

        function toggleAddStudentForm() {
            const panel = document.getElementById('student-add-panel');
            const trigger = document.getElementById('add-student-trigger');
            panel.classList.toggle('active');

            if (panel.classList.contains('active')) {
                trigger.style.opacity = '0.5';
                trigger.style.pointerEvents = 'none';
            } else {
                trigger.style.opacity = '1';
                trigger.style.pointerEvents = 'auto';
            }
        }

        function handleAddNewStudent(event) {
            event.preventDefault();
            const name = document.getElementById('new-std-name').value;
            const email = document.getElementById('new-std-email').value;
            const courses = document.getElementById('new-std-courses').value;

            const students = JSON.parse(localStorage.getItem('cs_students') || '[]');
            students.unshift({
                id: Date.now(),
                name,
                email,
                courses,
                last: 'Active Now'
            });

            localStorage.setItem('cs_students', JSON.stringify(students));
            loadStudents();
            toggleAddStudentForm();
            document.getElementById('add-student-form').reset();

            if (typeof showToast === 'function') showToast(`Successfully enrolled ${name}`, 'success');
        }

        function deleteStudent(id) {
            if (!confirm('Are you sure you want to remove this student?')) return;
            let students = JSON.parse(localStorage.getItem('cs_students') || '[]');
            students = students.filter(s => s.id !== id);
            localStorage.setItem('cs_students', JSON.stringify(students));
            loadStudents();
            if (typeof showToast === 'function') showToast('Student record removed', 'warning');
        }

        const conversations = {
            'Subhash': {
                name: 'Subhash (Student)',
                messages: [
                    { type: 'student', text: 'Hello, I registered for Kitchen 101 but Module 4 is still showing as locked. Can you please check?' },
                    { type: 'staff', text: "Hi Subhash, I can see your registration was successful. I'm manually unlocking the module for you now. Please refresh in 2 minutes." },
                    { type: 'student', text: 'Thank you! It\'s working now.' }
                ]
            },
            'Anand': {
                name: 'Anand (Student)',
                messages: [
                    { type: 'student', text: 'Hello, I have a grading query regarding Session 12 on Knife Skills. The feedback mentions a penalty for angle but I followed the guide exactly.' }
                ]
            },
            'Priya': {
                name: 'Priya Verma',
                messages: [
                    { type: 'student', text: 'Hi! I\'ve just submitted my final assignment for the Pastry Arts program. Looking forward to the results!' }
                ]
            },
            'Vikram': {
                name: 'Vikram Singh',
                messages: [
                    { type: 'student', text: 'Thanks for the course access info. I\'ll get started with the modules today.' },
                    { type: 'staff', text: 'Excellent, let me know if you run into any permission issues.' }
                ]
            },
            'Sneha': {
                name: 'Sneha Kapur',
                messages: [
                    { type: 'student', text: 'Can we reschedule the audit call? I have a scheduling conflict this Wednesday.' }
                ]
            },
            'Amit': {
                name: 'Amit Jain',
                messages: [
                    { type: 'student', text: 'Just checking on my enrollment status for the Advanced Butchery workshop.' }
                ]
            },
            'Ananya': {
                name: 'Ananya Iyer',
                messages: [
                    { type: 'student', text: 'Hello, my login credentials for the student portal are showing as invalid. I reset my password twice but no luck.' }
                ]
            },
            'Rohan': {
                name: 'Rohan Gupta',
                messages: [
                    { type: 'student', text: 'Dear Staff, I have completed the Level 1 Kitchen Safety course. How do I download the digital certificate?' }
                ]
            },
            'Ishita': {
                name: 'Ishita Dayal',
                messages: [
                    { type: 'student', text: 'I had a personal emergency and missed the Module 2 deadline. Is it possible to get a 2-day extension?' }
                ]
            },
            'Arjun': {
                name: 'Arjun Reddy',
                messages: [
                    { type: 'student', text: 'The live demo in Session 5 was incredible. The level of detail on plating really helped my project.' }
                ]
            },
            'Saira': {
                name: 'Saira Banu',
                messages: [
                    { type: 'student', text: 'I am interested in the Wine Pairing workshop. When is the next batch starting for evening participants?' }
                ]
            },
            'Kabir': {
                name: 'Kabir Singh',
                messages: [
                    { type: 'student', text: 'I made the payment for the masterclass yesterday but haven\'t received a confirmation email yet. Transaction ID is #8821.' }
                ]
            },
            'Meera': {
                name: 'Meera Nair',
                messages: [
                    { type: 'student', text: 'There is a typo in my name on the enrollment form. It says "Mera" instead of "Meera". Can you update it?' }
                ]
            },
            'Aditya': {
                name: 'Aditya Rao',
                messages: [
                    { type: 'student', text: 'How to access the culinary library? I see the link but it requests an additional token.' }
                ]
            },
            'Zoya': {
                name: 'Zoya Khan',
                messages: [
                    { type: 'student', text: 'Need help with the fermentation module. The timer settings on the simulation seem to be bugged.' }
                ]
            },
            'Dev': {
                name: 'Dev Thadani',
                messages: [
                    { type: 'student', text: 'Hello! I\'m interested in joining the student council. Who should I contact for the application process?' }
                ]
            },
            'Siddharth': {
                name: 'Siddharth M',
                messages: [
                    { type: 'student', text: 'Hi, I received my culinary audit results but I have a few questions about the efficiency score section.' }
                ]
            }
        };

        let currentConvo = 'Subhash';

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const history = document.getElementById('chat-history');
            const message = input.value.trim();

            if (!message) return;

            // Save to internal state
            conversations[currentConvo].messages.push({ type: 'staff', text: message });

            // Add Staff Message to UI
            const staffMsg = document.createElement('div');
            staffMsg.className = 'msg-bubble msg-staff';
            staffMsg.style.animation = 'entry 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
            staffMsg.textContent = message;
            history.appendChild(staffMsg);

            // Clear Input
            input.value = '';

            // Scroll to bottom
            history.scrollTo({
                top: history.scrollHeight,
                behavior: 'smooth'
            });

            if (typeof showToast === 'function') showToast(`Message sent to ${currentConvo}`, 'success');

            // Simulate student reply for realism
            const targetedConvo = currentConvo;
            setTimeout(() => {
                const replyText = "Copy that! I've received your update. Checking now.";
                conversations[targetedConvo].messages.push({ type: 'student', text: replyText });

                // Only update DOM if the user is still viewing this conversation
                if (currentConvo === targetedConvo) {
                    const studentMsg = document.createElement('div');
                    studentMsg.className = 'msg-bubble msg-student';
                    studentMsg.style.animation = 'entry 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
                    studentMsg.textContent = replyText;
                    history.appendChild(studentMsg);
                    history.scrollTo({
                        top: history.scrollHeight,
                        behavior: 'smooth'
                    });
                }
            }, 2000);
        }

        function selectConvo(id, element) {
            currentConvo = id;
            if (typeof showToast === 'function') showToast(`Switching to secure line: ${id}`, 'info');

            // Toggle active class
            document.querySelectorAll('.convo-item').forEach(i => i.classList.remove('active'));
            element.classList.add('active');

            // Update Header
            const chatHeader = document.querySelector('.chat-panel > div span');
            chatHeader.textContent = `Chat with ${conversations[id].name}`;

            // Load History
            const history = document.getElementById('chat-history');
            history.innerHTML = conversations[id].messages.map(m => `
                <div class="msg-bubble msg-${m.type}">${m.text}</div>
            `).join('');

            // Scroll to bottom
            history.scrollTo({ top: history.scrollHeight });
        }

        function enrollStudent() {
            const nameInput = document.getElementById('newStudentName');
            const emailInput = document.getElementById('newStudentEmail');
            const btn = event.currentTarget.tagName === 'BUTTON' ? event.currentTarget : null;
            const name = nameInput.value;
            const email = emailInput.value;

            if (!name || !email) {
                if (typeof showToast === 'function') showToast('Please enter identity and vector.', 'warning');
                return;
            }

            if (btn) {
                const originalText = btn.textContent;
                btn.disabled = true;
                btn.textContent = 'PROVISIONING...';

                setTimeout(() => {
                    const students = JSON.parse(localStorage.getItem('cs_students') || '[]');
                    students.unshift({
                        id: Date.now(),
                        name,
                        email,
                        courses: 1,
                        last: 'Just Now'
                    });

                    localStorage.setItem('cs_students', JSON.stringify(students));
                    nameInput.value = '';
                    emailInput.value = '';

                    if (typeof showToast === 'function') showToast(`Registered: ${name}`, 'success');
                    if (document.getElementById('view-students').style.display !== 'none') loadStudents();

                    btn.disabled = false;
                    btn.textContent = originalText;
                }, 1000);
            }
        }

        function openAudit(id) {
            const courses = JSON.parse(localStorage.getItem('cs_courses') || '[]');
            const course = courses.find(c => c.id === id) || { name: 'Unknown Course', students: 0 };

            const modal = document.getElementById('audit-modal');
            const container = document.getElementById('audit-data');

            container.innerHTML = `
                <div style="margin-bottom: 30px;">
                    <div class="hero__eyebrow" style="margin-bottom: 10px;">Instructional Audit</div>
                    <h2 style="font-size: 28px; font-weight: 900; margin: 0;">${course.name}</h2>
                    <p style="color: var(--text-muted); font-size: 14px; margin-top: 8px;">Comprehensive performance vector analysis.</p>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                    <div class="rb-card" style="padding: 20px; text-align: center;">
                        <div style="font-size: 10px; font-weight: 800; color: var(--text-muted); text-transform: uppercase;">Engagement Score</div>
                        <div style="font-size: 32px; font-weight: 900; color: var(--rb-primary); margin: 10px 0;">94%</div>
                        <div style="font-size: 11px; color: #4dff88;">OPTIMAL PACE</div>
                    </div>
                    <div class="rb-card" style="padding: 20px; text-align: center;">
                        <div style="font-size: 10px; font-weight: 800; color: var(--text-muted); text-transform: uppercase;">Grading Progress</div>
                        <div style="font-size: 32px; font-weight: 900; color: #4d94ff; margin: 10px 0;">${Math.floor(Math.random() * 20 + 80)}%</div>
                        <div style="font-size: 11px; color: var(--text-muted);">SYNCED</div>
                    </div>
                </div>

                <div class="rb-card" style="padding: 24px;">
                    <h4 style="margin: 0 0 15px 0; font-size: 14px; font-weight: 800; text-transform: uppercase; color: var(--text-muted);">Curriculum Completion Rate</h4>
                    <div style="display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 8px;">
                        <span>Module 1-6 Alpha</span>
                        <span style="font-weight: 800;">72%</span>
                    </div>
                    <div class="progress-bar-sm" style="height: 10px;">
                        <div class="progress-fill" style="width: 72%;"></div>
                    </div>
                </div>

                <button class="rb-btn" onclick="closeModal('audit-modal')" style="width: 100%; margin-top: 30px; font-size: 12px;">Close Report</button>
            `;

            modal.classList.add('active');
            if (typeof showToast === 'function') showToast(`Generating Audit Report: ${course.name}`, 'info');
        }

        function openRoster(id) {
            const courses = JSON.parse(localStorage.getItem('cs_courses') || '[]');
            const course = courses.find(c => c.id === id) || { name: 'Unknown Course' };
            const students = JSON.parse(localStorage.getItem('cs_students') || '[]');

            // Simulate filtered roster (since we don't have many-to-many, we take a slice or random selection)
            const count = Math.min(6, students.length);
            const roster = students.slice(0, count);

            const modal = document.getElementById('roster-modal');
            const container = document.getElementById('roster-data');

            container.innerHTML = `
                <div style="margin-bottom: 25px;">
                    <h2 style="font-size: 24px; font-weight: 900; margin: 0;">Student <span class="highlight">Roster</span></h2>
                    <p style="color: var(--text-muted); font-size: 13px; margin-top: 5px;">${course.name}</p>
                </div>
                
                <div class="roster-list">
                    ${roster.map(s => `
                        <div class="roster-item">
                            <div style="width: 36px; height: 36px; border-radius: 50%; background: var(--rb-primary); color: black; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 12px;">${s.name.charAt(0)}</div>
                            <div style="flex: 1;">
                                <div style="font-weight: 700; font-size: 14px;">${s.name}</div>
                                <div style="font-size: 11px; color: var(--text-muted);">${s.email}</div>
                            </div>
                            <div style="font-size: 10px; font-weight: 800; color: #4dff88;">ENROLLED</div>
                        </div>
                    `).join('')}
                </div>
                
                <button class="rb-btn" onclick="closeModal('roster-modal')" style="width: 100%; margin-top: 25px; font-size: 12px;">Close Roster</button>
            `;

            modal.classList.add('active');
            if (typeof showToast === 'function') showToast(`Loading Roster for ${course.name}`, 'success');
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
        }
    </script>
</body>

</html>